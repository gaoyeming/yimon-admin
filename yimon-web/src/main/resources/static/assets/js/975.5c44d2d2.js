"use strict";(self["webpackChunkyimon_vue"]=self["webpackChunkyimon_vue"]||[]).push([[975],{975:function(e,l,t){t.r(l),t.d(l,{default:function(){return X}});var a=t(6768);function o(e,l,t,o,i,r){const u=(0,a.g2)("CirclePlusFilled"),n=(0,a.g2)("el-icon"),d=(0,a.g2)("el-button"),s=(0,a.g2)("el-image"),p=(0,a.g2)("TableCustom"),c=(0,a.g2)("TableDetail"),m=(0,a.g2)("el-dialog"),b=(0,a.g2)("TableEdit");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(p,{"query-url":i.queryUrl,"query-form-data":i.queryFormData,options:i.queryOptions,columns:i.columns,rowKey:i.rowKey,tableData:i.page.data,tableTotal:i.page.total,pageNum:i.page.num,pageSize:i.page.size,pageCurrentChange:r.pageCurrentChange,pageSizeChange:r.pageSizeChange,viewFunc:r.viewFunc,editFunc:r.editFunc,delFunc:r.delFunc},{toolbarBtn:(0,a.k6)((()=>[(0,a.bF)(d,{type:"warning",onClick:l[0]||(l[0]=e=>i.editVisible=!0)},{default:(0,a.k6)((()=>[(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.bF)(u)])),_:1}),(0,a.eW)("新增")])),_:1})])),headPortraits:(0,a.k6)((({rows:e})=>[(0,a.bF)(s,{style:{display:"block",margin:"auto",width:"40px",height:"40px"},src:e.headPortraits},null,8,["src"])])),_:1},8,["query-url","query-form-data","options","columns","rowKey","tableData","tableTotal","pageNum","pageSize","pageCurrentChange","pageSizeChange","viewFunc","editFunc","delFunc"]),(0,a.bF)(m,{title:"查看详情",modelValue:i.viewVisible,"onUpdate:modelValue":l[1]||(l[1]=e=>i.viewVisible=e),width:"700px","destroy-on-close":""},{default:(0,a.k6)((()=>[(0,a.bF)(c,{title:i.viewTitle,list:i.viewList,row:i.viewRow},null,8,["title","list","row"])])),_:1},8,["modelValue"]),(0,a.bF)(m,{title:i.isEdit?"编辑":"新增",modelValue:i.editVisible,"onUpdate:modelValue":l[2]||(l[2]=e=>i.editVisible=e),width:"700px","destroy-on-close":"","close-on-click-modal":!1,onClose:r.closeDialog},{default:(0,a.k6)((()=>[(0,a.bF)(b,{"edit-form-data":i.editFormData,options:i.options,edit:i.isEdit,submitEditForm:r.submitEditForm},null,8,["edit-form-data","options","edit","submitEditForm"])])),_:1},8,["title","modelValue","onClose"])],64)}var i=t(144),r=t(4232);const u={class:"query-container"},n={key:0,class:"table-toolbar"},d={class:"table-toolbar-left"},s={class:"table-toolbar-right"},p={key:1},c={key:2};function m(e,l,t,o,i,m){const b=(0,a.g2)("el-input"),g=(0,a.g2)("el-option"),y=(0,a.g2)("el-select"),h=(0,a.g2)("el-date-picker"),F=(0,a.g2)("el-form-item"),f=(0,a.g2)("Search"),v=(0,a.g2)("el-icon"),k=(0,a.g2)("el-button"),w=(0,a.g2)("Refresh"),C=(0,a.g2)("el-form"),V=(0,a.g2)("Delete"),q=(0,a.g2)("el-tooltip"),_=(0,a.g2)("el-divider"),D=(0,a.g2)("Setting"),E=(0,a.g2)("el-checkbox"),S=(0,a.g2)("el-dropdown-item"),X=(0,a.g2)("el-dropdown-menu"),W=(0,a.g2)("el-dropdown"),T=(0,a.g2)("View"),z=(0,a.g2)("Edit"),x=(0,a.g2)("el-table-column"),U=(0,a.g2)("el-table"),N=(0,a.g2)("el-pagination");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",u,[(0,a.bF)(C,{ref:"queryRef",model:t.queryFormData,inline:!0},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.options,(e=>((0,a.uX)(),(0,a.Wv)(F,{label:e.label,prop:e.prop},{default:(0,a.k6)((()=>["input"===e.type?((0,a.uX)(),(0,a.Wv)(b,{key:0,modelValue:t.queryFormData[e.prop],"onUpdate:modelValue":l=>t.queryFormData[e.prop]=l,disabled:e.disabled,placeholder:e.placeholder,clearable:"",style:(0,r.Tr)(e.style)},null,8,["modelValue","onUpdate:modelValue","disabled","placeholder","style"])):"select"===e.type?((0,a.uX)(),(0,a.Wv)(y,{key:1,modelValue:t.queryFormData[e.prop],"onUpdate:modelValue":l=>t.queryFormData[e.prop]=l,disabled:e.disabled,placeholder:e.placeholder,clearable:"",style:(0,r.Tr)(e.style)},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.opts,(e=>((0,a.uX)(),(0,a.Wv)(g,{label:e.label,value:e.value},null,8,["label","value"])))),256))])),_:2},1032,["modelValue","onUpdate:modelValue","disabled","placeholder","style"])):"date"===e.type?((0,a.uX)(),(0,a.Wv)(h,{key:2,type:"date",modelValue:t.queryFormData[e.prop],"onUpdate:modelValue":l=>t.queryFormData[e.prop]=l,"value-format":e.format,style:(0,r.Tr)(e.style)},null,8,["modelValue","onUpdate:modelValue","value-format","style"])):(0,a.Q3)("",!0)])),_:2},1032,["label","prop"])))),256)),(0,a.bF)(F,null,{default:(0,a.k6)((()=>[(0,a.bF)(k,{type:"primary",onClick:m.handleQuery},{default:(0,a.k6)((()=>[(0,a.bF)(v,null,{default:(0,a.k6)((()=>[(0,a.bF)(f)])),_:1}),(0,a.eW)("查询")])),_:1},8,["onClick"]),(0,a.bF)(k,{onClick:m.resetForm},{default:(0,a.k6)((()=>[(0,a.bF)(v,null,{default:(0,a.k6)((()=>[(0,a.bF)(w)])),_:1}),(0,a.eW)("重置")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])]),t.hasToolbar?((0,a.uX)(),(0,a.CE)("div",n,[(0,a.Lk)("div",d,[(0,a.RG)(e.$slots,"toolbarBtn")]),(0,a.Lk)("div",s,[o.multipleSelection.length>0?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.bF)(q,{effect:"dark",content:"删除选中",placement:"top"},{default:(0,a.k6)((()=>[(0,a.bF)(v,{class:"columns-setting-icon",onClick:l[0]||(l[0]=e=>m.delSelection(o.multipleSelection))},{default:(0,a.k6)((()=>[(0,a.bF)(V)])),_:1})])),_:1}),(0,a.bF)(_,{direction:"vertical"})],64)):(0,a.Q3)("",!0),(0,a.bF)(q,{effect:"dark",content:"刷新",placement:"top"},{default:(0,a.k6)((()=>[(0,a.bF)(v,{class:"columns-setting-icon",onClick:t.refresh},{default:(0,a.k6)((()=>[(0,a.bF)(w)])),_:1},8,["onClick"])])),_:1}),(0,a.bF)(_,{direction:"vertical"}),(0,a.bF)(q,{effect:"dark",content:"列设置",placement:"top"},{default:(0,a.k6)((()=>[(0,a.bF)(W,{"hide-on-click":!1,size:"small",trigger:"click"},{dropdown:(0,a.k6)((()=>[(0,a.bF)(X,null,{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.columns,(e=>((0,a.uX)(),(0,a.Wv)(S,null,{default:(0,a.k6)((()=>[(0,a.bF)(E,{modelValue:e.visible,"onUpdate:modelValue":l=>e.visible=l,label:e.label},null,8,["modelValue","onUpdate:modelValue","label"])])),_:2},1024)))),256))])),_:1})])),default:(0,a.k6)((()=>[(0,a.bF)(v,{class:"columns-setting-icon"},{default:(0,a.k6)((()=>[(0,a.bF)(D)])),_:1})])),_:1})])),_:1})])])):(0,a.Q3)("",!0),(0,a.bF)(U,{data:t.tableData,style:{width:"100%"},"row-key":t.rowKey,stripe:"",border:"",onSelectionChange:o.handleSelectionChange,"table-layout":"auto"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.columns,(l=>((0,a.uX)(),(0,a.CE)(a.FK,{key:l.prop},[l.visible?((0,a.uX)(),(0,a.Wv)(x,{key:0,prop:l.prop,label:l.label,width:l.width,type:l.type,align:l.align||"center"},(0,a.eX)({_:2},["index"===l.type?{name:"default",fn:(0,a.k6)((({row:e,column:l,$index:t})=>[(0,a.eW)((0,r.v_)(m.getIndex(t)),1)])),key:"0"}:void 0,l.type?void 0:{name:"default",fn:(0,a.k6)((({row:o,column:i,$index:u})=>[(0,a.RG)(e.$slots,l.prop,{rows:o,index:u},(()=>["operator"==l.prop?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.bF)(k,{type:"warning",size:"small",onClick:e=>t.viewFunc(o)},{default:(0,a.k6)((()=>[(0,a.bF)(v,null,{default:(0,a.k6)((()=>[(0,a.bF)(T)])),_:1}),(0,a.eW)("查看 ")])),_:2},1032,["onClick"]),(0,a.bF)(k,{type:"primary",size:"small",onClick:e=>t.editFunc(o)},{default:(0,a.k6)((()=>[(0,a.bF)(v,null,{default:(0,a.k6)((()=>[(0,a.bF)(z)])),_:1}),(0,a.eW)("编辑 ")])),_:2},1032,["onClick"]),(0,a.bF)(k,{type:"danger",size:"small",onClick:e=>m.handleDelete(o)},{default:(0,a.k6)((()=>[(0,a.bF)(v,null,{default:(0,a.k6)((()=>[(0,a.bF)(V)])),_:1}),(0,a.eW)("删除 ")])),_:2},1032,["onClick"])],64)):l.formatter?((0,a.uX)(),(0,a.CE)("span",p,(0,r.v_)(l.formatter(o[l.prop])),1)):((0,a.uX)(),(0,a.CE)("span",c,(0,r.v_)(o[l.prop]),1))]))])),key:"1"}]),1032,["prop","label","width","type","align"])):(0,a.Q3)("",!0)],64)))),128))])),_:3},8,["data","row-key","onSelectionChange"]),t.hasPagination?((0,a.uX)(),(0,a.Wv)(N,{key:1,size:"mini",layout:"total, sizes, prev, pager, next, jumper",total:t.tableTotal,"current-page":t.pageNum,"page-size":t.pageSize,"page-sizes":[10,20,50,100],onCurrentChange:t.pageCurrentChange,onSizeChange:t.pageSizeChange,background:!0},null,8,["total","current-page","page-size","onCurrentChange","onSizeChange"])):(0,a.Q3)("",!0)],64)}var b=t(2933),g={name:"TableCustom",props:{queryUrl:{type:String,required:!1},queryFormData:{type:Object,required:!0},options:{type:Array,required:!0},queryFunc:{type:Function,required:!1},hasToolbar:{type:Boolean,default:!0},columns:{type:Array,required:!0,default:[]},tableData:{type:Array,default:[]},rowKey:{type:String,default:"id"},multipleSelection:{type:Array,default:[]},hasPagination:{type:Boolean,default:!0},tableTotal:{type:Number,default:0},pageNum:{type:Number,default:1},pageSize:{type:Number,default:10},pageCurrentChange:{type:Function,default:()=>{}},pageSizeChange:{type:Function,default:()=>{}},refresh:{type:Function,default:()=>{}},viewFunc:{type:Function,default:()=>{}},editFunc:{type:Function,default:()=>{}},delFunc:{type:Function,default:()=>{}}},setup(e){const l=(0,i.KR)(e.multipleSelection),t=e=>{l.value=e},a=(0,i.KR)(e.columns);return a.value.forEach((e=>{void 0===e.visible&&(e.visible=!0)})),{columns:a,multipleSelection:l,handleSelectionChange:t}},methods:{handleQuery(){if(this.queryFunc)this.queryFunc();else{var e={};for(let l in this.queryFormData)this.queryFormData[l]&&(e[l]=this.queryFormData[l]);this.pageNum&&this.pageNum>0&&this.pageSize&&this.pageSize>0&&(e["@PAGE_NO@"]=this.pageNum,e["@PAGE_SIZE@"]=this.pageSize),this.$axios.post(this.queryUrl,e).then((e=>{this.tableTotal=e["@TOTAL@"],this.tableData=e["@RESULT@"]})).catch((e=>{console.error("request error:",e)}))}},resetForm(){this.$refs["queryRef"]&&(this.$refs["queryRef"].resetFields(),this.queryFunc())},getIndex(e){return e+1+(this.pageNum-1)*this.pageSize},handleDelete(e){b.s.confirm("确定删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.delFunc(e)})).catch((()=>{}))},delSelection(e){!e||e.length<=0||b.s.confirm("确定删除选中数据？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{e.forEach((e=>{this.delFunc(e)}))})).catch((()=>{}))}}},y=t(1241);const h=(0,y.A)(g,[["render",m]]);var F=h;function f(e,l,t,o,i,u){const n=(0,a.g2)("el-descriptions-item"),d=(0,a.g2)("el-descriptions");return(0,a.uX)(),(0,a.Wv)(d,{title:t.title,column:t.column,border:""},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.list,(l=>((0,a.uX)(),(0,a.Wv)(n,{span:l.span},{label:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)(l.label),1)])),default:(0,a.k6)((()=>[(0,a.RG)(e.$slots,l.prop,{rows:t.row},(()=>[(0,a.eW)((0,r.v_)(l.value||t.row[l.prop]),1)]))])),_:2},1032,["span"])))),256))])),_:3},8,["title","column"])}var v={name:"TableDetail",props:{title:{type:String,required:!0},column:{type:Number,default:2},list:{type:Array,default:[],required:!0},row:{type:Object,default:{},required:!0}}};const k=(0,y.A)(v,[["render",f]]);var w=k;const C=["src"];function V(e,l,t,o,i,r){const u=(0,a.g2)("el-input"),n=(0,a.g2)("el-input-number"),d=(0,a.g2)("el-option"),s=(0,a.g2)("el-select"),p=(0,a.g2)("el-date-picker"),c=(0,a.g2)("el-switch"),m=(0,a.g2)("Plus"),b=(0,a.g2)("el-icon"),g=(0,a.g2)("el-upload"),y=(0,a.g2)("el-form-item"),h=(0,a.g2)("el-col"),F=(0,a.g2)("el-row"),f=(0,a.g2)("el-button"),v=(0,a.g2)("el-form");return(0,a.uX)(),(0,a.Wv)(v,{ref:"editRef",model:t.editFormData,rules:t.rules,"label-width":t.options.labelWidth},{default:(0,a.k6)((()=>[(0,a.bF)(F,null,{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.options.list,(l=>((0,a.uX)(),(0,a.Wv)(h,{span:t.options.span},{default:(0,a.k6)((()=>[(0,a.bF)(y,{label:l.label,prop:l.prop},{default:(0,a.k6)((()=>["input"===l.type?((0,a.uX)(),(0,a.Wv)(u,{key:0,modelValue:t.editFormData[l.prop],"onUpdate:modelValue":e=>t.editFormData[l.prop]=e,disabled:l.disabled,placeholder:l.placeholder,clearable:""},null,8,["modelValue","onUpdate:modelValue","disabled","placeholder"])):"number"===l.type?((0,a.uX)(),(0,a.Wv)(n,{key:1,modelValue:t.editFormData[l.prop],"onUpdate:modelValue":e=>t.editFormData[l.prop]=e,disabled:l.disabled,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue","disabled"])):"select"===l.type?((0,a.uX)(),(0,a.Wv)(s,{key:2,modelValue:t.editFormData[l.prop],"onUpdate:modelValue":e=>t.editFormData[l.prop]=e,disabled:l.disabled,placeholder:l.placeholder,clearable:""},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.opts,(e=>((0,a.uX)(),(0,a.Wv)(d,{label:e.label,value:e.value},null,8,["label","value"])))),256))])),_:2},1032,["modelValue","onUpdate:modelValue","disabled","placeholder"])):"date"===l.type?((0,a.uX)(),(0,a.Wv)(p,{key:3,type:"date",modelValue:t.editFormData[l.prop],"onUpdate:modelValue":e=>t.editFormData[l.prop]=e,"value-format":l.format},null,8,["modelValue","onUpdate:modelValue","value-format"])):"switch"===l.type?((0,a.uX)(),(0,a.Wv)(c,{key:4,modelValue:t.editFormData[l.prop],"onUpdate:modelValue":e=>t.editFormData[l.prop]=e,"active-value":l.activeValue,"inactive-value":l.inactiveValue,"active-text":l.activeText,"inactive-text":l.inactiveText},null,8,["modelValue","onUpdate:modelValue","active-value","inactive-value","active-text","inactive-text"])):"upload"===l.type?((0,a.uX)(),(0,a.Wv)(g,{key:5,class:"avatar-uploader",action:"#","show-file-list":!1,"on-success":e.handleAvatarSuccess},{default:(0,a.k6)((()=>[t.editFormData[l.prop]?((0,a.uX)(),(0,a.CE)("img",{key:0,src:t.editFormData[l.prop],class:"avatar"},null,8,C)):((0,a.uX)(),(0,a.Wv)(b,{key:1,class:"avatar-uploader-icon"},{default:(0,a.k6)((()=>[(0,a.bF)(m)])),_:1}))])),_:2},1032,["on-success"])):(0,a.RG)(e.$slots,l.prop,{key:6})])),_:2},1032,["label","prop"])])),_:2},1032,["span"])))),256))])),_:3}),(0,a.bF)(y,null,{default:(0,a.k6)((()=>[(0,a.bF)(f,{type:"primary",onClick:r.saveEdit},{default:(0,a.k6)((()=>[(0,a.eW)("保 存")])),_:1},8,["onClick"])])),_:1})])),_:3},8,["model","rules","label-width"])}var q={name:"TableEdit",props:{edit:{type:Boolean,default:!1,required:!0},editFormData:{type:Object,default:{},required:!0},rules:{type:Array,default:[],required:!0},options:{type:Object,default:{},required:!0},submitEditForm:{type:Function,default:()=>{}}},setup(e){},methods:{saveEdit(){this.$refs["editRef"]&&this.$refs["editRef"].validate((e=>{if(!e)return!1;this.submitEditForm(this.editFormData)}))}}};const _=(0,y.A)(q,[["render",V]]);var D=_,E={name:"UserView",components:{TableCustom:F,TableDetail:w,TableEdit:D},data(){return{queryUrl:"/crud/sys_user/gets",queryFormData:{loginName:null,realName:null},queryOptions:[{prop:"loginName",label:"登录名",type:"input"},{prop:"realName",label:"真实姓名",type:"input"}],columns:(0,i.KR)([{type:"selection"},{type:"index",label:"序号",align:"center",width:"80"},{prop:"loginName",label:"登录名"},{prop:"headPortraits",label:"头像"},{prop:"realName",label:"真实姓名"},{prop:"contactEmail",label:"联系邮箱"},{prop:"contactMobile",label:"联系电话",formatter:e=>{const l=e.slice(-8,-4).replace(/\d/g,"*");return e.slice(0,-8)+l+e.slice(-4)}},{prop:"contactAddress",label:"联系地址"},{prop:"operator",label:"操作"}]),rowKey:"id",page:{data:[],total:0,num:1,size:10},viewVisible:!1,viewTitle:null,viewList:null,viewRow:null,editFormData:{},options:{labelWidth:"100px",span:24,list:[{type:"input",label:"登录名",prop:"loginName",required:!0},{type:"input",label:"真实姓名",prop:"realName",required:!0},{type:"input",label:"联系邮箱",prop:"contactEmail",required:!0},{type:"input",label:"联系电话",prop:"contactMobile",required:!0},{type:"input",label:"联系地址",prop:"contactAddress",required:!0}]},isEdit:!1,editVisible:!1}},created(){this.queryFunc()},methods:{queryFunc(){console.log(2222)},viewFunc(e){this.viewTitle="用户信息",this.viewList=[{prop:"loginName",label:"登录名"},{prop:"realName",label:"真实姓名"},{prop:"contactEmail",label:"联系邮箱"},{prop:"contactMobile",label:"联系电话"},{prop:"contactAddress",label:"联系地址"}],this.viewRow=e,this.viewVisible=!0},editFunc(e){this.editFormData=e,this.isEdit=!0,this.editVisible=!0},delFunc(e){var l={id:e.id};this.$axios.post("/crud/sys_user/delete",l).then((e=>{null!=e["@ROWS@"]&&1===e["@ROWS@"]?this.$message.success({message:"删除成功",duration:3e3}):this.$message.warning({message:"删除失败，请刷新后重试",duration:3e3})})).finally((()=>{setTimeout((()=>{this.queryFunc()}),1e3)}))},pageCurrentChange(e){this.page.num=e,this.handleSearch()},pageSizeChange(e){this.page.size=e,this.handleSearch()},submitEditForm(e){this.$axios.post(this.isEdit?"/crud/sys_user/post":"/crud/sys_user/put",e).then((e=>{null!=e["@ROWS@"]&&1===e["@ROWS@"]?this.$message.success({message:"提交成功",duration:3e3}):this.$message.warning({message:"提交失败，请确认！",duration:3e3})})).catch((e=>{console.error("request error:",e)})).finally((()=>{setTimeout((()=>{this.queryFunc()}),1e3)}))},closeDialog(){this.editFormData={},this.isEdit=!1,this.editVisible=!1}}};const S=(0,y.A)(E,[["render",o]]);var X=S}}]);