"use strict";(self["webpackChunkyimon_vue"]=self["webpackChunkyimon_vue"]||[]).push([[371],{3371:function(e,o,t){t.r(o),t.d(o,{default:function(){return u}});var i=t(6768);const l={class:"login"},a={class:"login-bg"},s={class:"login-form"},n={class:"input-right-icon"};function r(e,o,r,g,c,p){const u=(0,i.g2)("el-image"),h=(0,i.g2)("el-divider"),d=(0,i.g2)("el-input"),m=(0,i.g2)("User"),w=(0,i.g2)("el-icon"),F=(0,i.g2)("el-form-item"),b=(0,i.g2)("el-button"),_=(0,i.g2)("el-form");return(0,i.uX)(),(0,i.CE)("div",l,[(0,i.Lk)("div",a,[(0,i.bF)(u,{style:{width:"300px",height:"300px"},src:t(5549)},null,8,["src"])]),(0,i.bF)(h,{direction:"vertical"}),(0,i.Lk)("div",s,[(0,i.bF)(_,{"label-position":"right",rules:c.loginRules,"label-width":"80px",model:c.loginForm,ref:"loginRef"},{default:(0,i.k6)((()=>[(0,i.bF)(F,{label:"用户名",prop:"loginName"},{default:(0,i.k6)((()=>[(0,i.bF)(d,{modelValue:c.loginForm.loginName,"onUpdate:modelValue":o[0]||(o[0]=e=>c.loginForm.loginName=e),placeholder:"请输入用户名"},null,8,["modelValue"]),(0,i.Lk)("span",n,[(0,i.bF)(w,null,{default:(0,i.k6)((()=>[(0,i.bF)(m)])),_:1})])])),_:1}),(0,i.bF)(F,{label:"密码",prop:"loginPassword"},{default:(0,i.k6)((()=>[(0,i.bF)(d,{type:c.loginPassword_input_type,modelValue:c.loginForm.loginPassword,"onUpdate:modelValue":o[1]||(o[1]=e=>c.loginForm.loginPassword=e),placeholder:"请输入密码"},null,8,["type","modelValue"]),(0,i.Lk)("span",{class:"input-right-icon",onClick:o[2]||(o[2]=(...e)=>p.showLoginPassword&&p.showLoginPassword(...e))},[((0,i.uX)(),(0,i.Wv)((0,i.$y)(c.loginPassword_input_icon),{style:{width:"1em"}}))])])),_:1}),(0,i.bF)(F,{label:"验证码",prop:"captcha"},{default:(0,i.k6)((()=>[(0,i.bF)(d,{modelValue:c.loginForm.captcha,"onUpdate:modelValue":o[3]||(o[3]=e=>c.loginForm.captcha=e),style:{width:"150px",float:"left"},maxlength:"6",placeholder:"请输入验证码"},null,8,["modelValue"]),(0,i.bF)(u,{src:c.captchaImg,onClick:o[4]||(o[4]=e=>p.getCaptchaImg()),style:{width:"120px",float:"right"}},null,8,["src"])])),_:1}),(0,i.bF)(F,null,{default:(0,i.k6)((()=>[(0,i.bF)(b,{type:"primary",onClick:o[5]||(o[5]=e=>p.login("loginRef"))},{default:(0,i.k6)((()=>[(0,i.eW)("登录")])),_:1}),(0,i.bF)(b,{onClick:o[6]||(o[6]=o=>e.$resetForm("loginRef"))},{default:(0,i.k6)((()=>[(0,i.eW)("重置")])),_:1})])),_:1})])),_:1},8,["rules","model"])])])}t(4114),t(4979);var g={name:"LoginView",data(){return{loginForm:{loginName:"admin",loginPassword:"123456",captchaType:"",captchaKey:"",captcha:""},loginRules:{loginName:[{required:!0,message:"请输入用户名",trigger:"blur"}],loginPassword:[{required:!0,message:"请输入密码",trigger:"blur"}],captcha:[{required:!0,message:"请输入验证码",trigger:"blur"},{min:1,max:5,message:"验证码为1~5个字符",trigger:"blur"}]},captchaImg:"",loginPassword_input_type:"password",loginPassword_input_icon:"Hide"}},created(){this.getCaptchaImg()},methods:{getCaptchaImg(){this.loginForm.captchaType="login",this.loginForm.captchaKey=this.$commonUtils.getUuid();const e={captchaType:this.loginForm.captchaType,captchaKey:this.loginForm.captchaKey};this.$axios.post("/verify/captcha/create",e).then((e=>{null!=e["captchaImg"]&&(this.captchaImg="data:image/png;base64,"+e["captchaImg"])})).catch((e=>{console.error("request error:",e)}))},showLoginPassword(){"password"===this.loginPassword_input_type?(this.loginPassword_input_icon="View",this.loginPassword_input_type=""):(this.loginPassword_input_icon="Hide",this.loginPassword_input_type="password")},login(e){this.$refs[e].validate((o=>{o&&(this.loginForm.loginPassword=btoa(this.loginForm.loginPassword),this.$axios.post("/user/login",this.loginForm).then((e=>{this.$message.success({message:e.user.loginName+"【登录成功】",duration:3e3}),this.$store.state.token=e.token,this.$store.commit("login",e.user),this.$store.state.menu.menuList=e.menuList,this.$router.push("/")})).catch((e=>{console.error("request error:",e)})).finally((()=>{this.$resetForm(e),this.getCaptchaImg()})))}))}}},c=t(1241);const p=(0,c.A)(g,[["render",r]]);var u=p}}]);